(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,18566,(e,t,s)=>{t.exports=e.r(76562)},70258,e=>{"use strict";var t=e.i(43476),s=e.i(71645),a=e.i(18566);function i(e){return new Date(e).toLocaleString(void 0,{weekday:"short",day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"})}function n(){let e=(0,a.useRouter)(),[n,l]=(0,s.useState)([]),[o,c]=(0,s.useState)(!1),[r,d]=(0,s.useState)(""),[h,p]=(0,s.useState)(!0),m=(0,s.useMemo)(()=>{let e=h?"?upcoming=1":"";return`/api/admin/bookings${e}`},[h]);async function x(){d(""),c(!0);try{let e=await fetch(m,{cache:"no-store"}),t=await e.json().catch(()=>({}));if(!e.ok)throw Error(t?.error||`Failed (${e.status})`);l(Array.isArray(t?.bookings)?t.bookings:[])}catch(e){d(e?.message||"Failed to load."),l([])}finally{c(!1)}}function g(e){navigator.clipboard?.writeText(e).catch(()=>{})}return(0,s.useEffect)(()=>{x()},[m]),(0,t.jsx)("div",{className:"section",children:(0,t.jsxs)("div",{className:"card",children:[(0,t.jsx)("div",{className:"badge",children:"Admin"}),(0,t.jsx)("h1",{className:"h1",style:{fontSize:44,marginTop:12},children:"Bookings & client contacts"}),(0,t.jsx)("p",{className:"p",children:"Use this list to message clients on WhatsApp. You can also export CSV."}),(0,t.jsxs)("div",{style:{display:"flex",gap:12,flexWrap:"wrap",marginTop:14},children:[(0,t.jsx)("button",{className:"btn btnGhost",onClick:()=>e.push("/admin/slots"),children:"Slots"}),(0,t.jsx)("button",{className:"btn btnGhost",onClick:()=>e.push("/"),children:"Home"}),(0,t.jsx)("button",{className:"btn btnGhost",onClick:x,disabled:o,children:o?"Refreshing...":"Refresh"}),(0,t.jsx)("button",{className:"btn btnGhost",onClick:function(){let e=new Blob([[["bookingId","start","end","deviceTimezone","leadEmail","leadPhone","leadCountry","leadTimezone","createdAt"],...n.map(e=>[e.id,e.slot.startsAt,e.slot.endsAt,e.timezone||"",e.lead.email,e.lead.phone,e.lead.country,e.lead.timezone,e.createdAt])].map(e=>e.map(e=>`"${String(e).replaceAll('"','""')}"`).join(",")).join("\n")],{type:"text/csv;charset=utf-8;"}),t=URL.createObjectURL(e),s=document.createElement("a");s.href=t,s.download="bookings.csv",s.click(),URL.revokeObjectURL(t)},disabled:0===n.length,children:"Export CSV"}),(0,t.jsxs)("label",{className:"p",style:{display:"flex",gap:10,alignItems:"center"},children:[(0,t.jsx)("input",{type:"checkbox",checked:h,onChange:e=>p(e.target.checked)}),"Show only upcoming"]})]}),r&&(0,t.jsxs)("div",{className:"card",style:{borderColor:"rgba(255,120,120,0.6)",marginTop:14},children:[(0,t.jsx)("b",{style:{color:"#ffd4d4"},children:"Fix this"}),(0,t.jsx)("div",{className:"p",style:{marginTop:6},children:r}),(0,t.jsx)("div",{className:"p",style:{marginTop:8,opacity:.9},children:"If you see “Unauthorized”, it means your admin email isn’t allowed. Add it to ADMIN_EMAILS / ADMIN_EMAIL in your env vars."})]}),(0,t.jsx)("div",{className:"card",style:{marginTop:14},children:o?(0,t.jsx)("div",{className:"p",children:"Loading..."}):0===n.length?(0,t.jsx)("div",{className:"p",children:"No bookings found."}):(0,t.jsx)("div",{style:{display:"grid",gap:12},children:n.map(e=>{let s;return(0,t.jsx)("div",{className:"card",style:{background:"rgba(10,16,32,0.35)"},children:(0,t.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",gap:12},children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{style:{fontWeight:800,fontSize:18},children:[i(e.slot.startsAt)," → ",i(e.slot.endsAt)]}),(0,t.jsxs)("div",{className:"p",style:{marginTop:6,opacity:.9},children:[(0,t.jsx)("b",{children:"Email:"})," ",e.lead.email," ",(0,t.jsx)("button",{className:"btn btnGhost",style:{padding:"6px 10px",marginLeft:8},onClick:()=>g(e.lead.email),children:"Copy"})]}),(0,t.jsxs)("div",{className:"p",style:{marginTop:6,opacity:.9},children:[(0,t.jsx)("b",{children:"WhatsApp:"})," ",e.lead.phone," ",(0,t.jsx)("button",{className:"btn btnGhost",style:{padding:"6px 10px",marginLeft:8},onClick:()=>g(e.lead.phone),children:"Copy"})," ",(0,t.jsx)("a",{className:"btn btnPrimary",style:{padding:"6px 10px",marginLeft:8},href:(s=e.lead.phone.replace(/\D/g,""),`https://wa.me/${s}`),target:"_blank",rel:"noreferrer",children:"Open chat"})]}),(0,t.jsxs)("div",{className:"p",style:{marginTop:8,opacity:.8},children:[(0,t.jsx)("b",{children:"Device TZ:"})," ",e.timezone||"N/A"," • ",(0,t.jsx)("b",{children:"Lead TZ:"})," ",e.lead.timezone," •"," ",(0,t.jsx)("b",{children:"Country:"})," ",e.lead.country]}),(0,t.jsxs)("div",{className:"p",style:{marginTop:6,opacity:.75},children:[(0,t.jsx)("b",{children:"Booking ID:"})," ",e.id," ",(0,t.jsx)("button",{className:"btn btnGhost",style:{padding:"6px 10px",marginLeft:8},onClick:()=>g(e.id),children:"Copy"})]})]}),(0,t.jsxs)("div",{className:"p",style:{opacity:.7,whiteSpace:"nowrap"},children:["Created: ",i(e.createdAt)]})]})},e.id)})})})]})})}e.s(["default",()=>n])}]);