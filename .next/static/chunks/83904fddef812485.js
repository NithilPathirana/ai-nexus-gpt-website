(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,18566,(e,t,s)=>{t.exports=e.r(76562)},70587,e=>{"use strict";var t=e.i(43476),s=e.i(71645),i=e.i(18566);function a(e,t){let s=new Date(e);return new Intl.DateTimeFormat(void 0,{weekday:"short",day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit",timeZone:t||void 0}).format(s)}function l(){let e=(0,i.useRouter)(),[l,n]=(0,s.useState)([]),[d,o]=(0,s.useState)(!1),[r,c]=(0,s.useState)(""),[h,m]=(0,s.useState)(""),p=(0,s.useMemo)(()=>"Nexus GPT",[]);async function y(){c(""),m(""),o(!0);try{let e=await fetch("/api/admin/leads",{cache:"no-store"}),t=await e.json().catch(()=>({}));if(!e.ok)throw Error(t?.error||`Failed (${e.status})`);n(Array.isArray(t?.leads)?t.leads:[])}catch(e){c(e?.message||"Failed to load leads."),n([])}finally{o(!1)}}async function g(e){try{let t=function(e){let t=e.latestBooking;if(!t?.startsAt||!t?.endsAt)return`Hi! This is ${p}. We received your details, but your booking time isn't attached yet. Reply here and weâ€™ll confirm a time.`;let s=t.timezone||e.timezone||"Asia/Colombo",i=a(t.startsAt,s),l=a(t.endsAt,s),n=t.zoomJoinUrl||"[PASTE_ZOOM_LINK_HERE]";return`Hi! This is ${p} âœ…

Your onboarding call is booked.

ðŸ•’ Time: ${i} â€“ ${l}
ðŸŒ Timezone: ${s}
ðŸ”— Zoom: ${n}

Reply â€œOKâ€ to confirm.`}(e);await navigator.clipboard.writeText(t),m("Copied WhatsApp message âœ…"),setTimeout(()=>m(""),1400)}catch{c("Could not copy. Your browser blocked clipboard access.")}}async function u(e){if(c(""),m(""),confirm("Delete this lead? This removes their bookings too."))try{let t=await fetch(`/api/admin/leads/${e}`,{method:"DELETE"}),s=await t.json().catch(()=>({}));if(!t.ok)throw Error(s?.error||`Delete failed (${t.status})`);m("Deleted âœ…"),n(t=>t.filter(t=>t.id!==e)),setTimeout(()=>m(""),1400)}catch(e){c(e?.message||"Delete failed.")}}return(0,s.useEffect)(()=>{y()},[]),(0,t.jsx)("div",{className:"section",children:(0,t.jsxs)("div",{className:"card",children:[(0,t.jsx)("div",{className:"badge",children:"Admin"}),(0,t.jsx)("h1",{className:"h1",style:{fontSize:44,marginTop:12},children:"Leads"}),(0,t.jsx)("p",{className:"p",children:"View client details + latest booking, copy a WhatsApp message, then delete once contacted."}),(0,t.jsxs)("div",{style:{display:"flex",gap:12,flexWrap:"wrap",marginTop:14},children:[(0,t.jsx)("button",{className:"btn btnGhost",onClick:()=>e.push("/admin/slots"),children:"Slots"}),(0,t.jsx)("button",{className:"btn btnGhost",onClick:y,disabled:d,children:d?"Refreshing...":"Refresh"})]}),r&&(0,t.jsxs)("div",{className:"card",style:{borderColor:"rgba(255,120,120,0.6)",marginTop:14},children:[(0,t.jsx)("b",{style:{color:"#ffd4d4"},children:"Fix this"}),(0,t.jsx)("div",{className:"p",style:{marginTop:6},children:r})]}),h&&(0,t.jsxs)("div",{className:"card",style:{borderColor:"rgba(120,255,160,0.35)",marginTop:14},children:[(0,t.jsx)("b",{style:{color:"#d6ffe3"},children:"Done"}),(0,t.jsx)("div",{className:"p",style:{marginTop:6},children:h})]}),(0,t.jsx)("div",{className:"card",style:{marginTop:14,overflowX:"auto"},children:0!==l.length||d?(0,t.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",minWidth:900},children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{style:{textAlign:"left",opacity:.9},children:[(0,t.jsx)("th",{style:{padding:10},children:"Email"}),(0,t.jsx)("th",{style:{padding:10},children:"WhatsApp"}),(0,t.jsx)("th",{style:{padding:10},children:"Country"}),(0,t.jsx)("th",{style:{padding:10},children:"Lead TZ"}),(0,t.jsx)("th",{style:{padding:10},children:"Latest booking"}),(0,t.jsx)("th",{style:{padding:10},children:"Actions"})]})}),(0,t.jsx)("tbody",{children:l.map(e=>{let s=e.latestBooking,i=s?.startsAt&&s?.endsAt?`${a(s.startsAt,s.timezone||e.timezone)} â†’ ${a(s.endsAt,s.timezone||e.timezone)}`:"â€”";return(0,t.jsxs)("tr",{style:{borderTop:"1px solid rgba(255,255,255,0.08)"},children:[(0,t.jsx)("td",{style:{padding:10,fontWeight:650},children:e.email}),(0,t.jsx)("td",{style:{padding:10},children:e.phone}),(0,t.jsx)("td",{style:{padding:10},children:e.country}),(0,t.jsx)("td",{style:{padding:10},children:e.timezone}),(0,t.jsxs)("td",{style:{padding:10},children:[(0,t.jsx)("div",{style:{fontWeight:650},children:i}),s?.id?(0,t.jsxs)("div",{className:"p",style:{marginTop:4,opacity:.8},children:["Booking ID: ",s.id]}):null]}),(0,t.jsx)("td",{style:{padding:10},children:(0,t.jsxs)("div",{style:{display:"flex",gap:10,flexWrap:"wrap"},children:[(0,t.jsx)("button",{className:"btn btnGhost",onClick:()=>g(e),children:"Copy WhatsApp message"}),(0,t.jsx)("button",{className:"btn btnGhost",onClick:()=>u(e.id),style:{borderColor:"rgba(255,120,120,0.35)"},children:"Delete"})]})})]},e.id)})})]}):(0,t.jsx)("div",{className:"p",children:"No leads yet."})})]})})}e.s(["default",()=>l])}]);