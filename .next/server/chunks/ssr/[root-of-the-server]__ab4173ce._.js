module.exports=[72131,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].React},9270,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.AppRouterContext},36313,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.HooksClientContext},18341,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.ServerInsertedHtml},18622,(a,b,c)=>{b.exports=a.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},20635,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},42602,(a,b,c)=>{"use strict";b.exports=a.r(18622)},87924,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactJsxRuntime},67253,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944);function e(a){if("u"<typeof document)return null;let b=document.cookie.split(";").map(a=>a.trim()).find(b=>b.startsWith(a+"="));return b?decodeURIComponent(b.split("=").slice(1).join("=")):null}function f(a){return new Date(a).toLocaleString(void 0,{weekday:"short",day:"2-digit",month:"short",hour:"2-digit",minute:"2-digit"})}function g(){let a=(0,d.useRouter)(),[g,h]=(0,c.useState)([]),[i,j]=(0,c.useState)(""),[k,l]=(0,c.useState)(!1),[m,n]=(0,c.useState)(!1),[o,p]=(0,c.useState)(""),[q,r]=(0,c.useState)(""),s=(0,c.useMemo)(()=>Intl.DateTimeFormat().resolvedOptions().timeZone||"Asia/Colombo",[]);async function t(){p(""),l(!0);try{let a=await fetch("/api/onboarding/slots",{cache:"no-store"}),b=await a.json().catch(()=>({}));if(!a.ok)throw Error(b?.error||`Failed to load slots (${a.status})`);let c=Array.isArray(b?.slots)?b.slots:[];if(h(c),c.length>0){let a=c.some(a=>a.id===i);i&&a||j(c[0].id)}else j("")}catch(a){p(a?.message||"Could not load slots."),h([]),j("")}finally{l(!1)}}async function u(){if(p(""),r(""),!e("nexus_lead"))return void p("Missing lead id. Go back to Step 2 and click Next again.");if(!i)return void p("Please select a slot.");n(!0);try{let b=await fetch("/api/onboarding/book",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({slotId:i,timezone:s})}),c=await b.json().catch(()=>({}));if(!b.ok)throw Error(c?.error||`Booking failed (${b.status})`);let d=c?.bookingId||c?.booking?.id;r("Booked! Redirecting..."),await t(),d?a.push(`/onboarding/confirmed?b=${encodeURIComponent(d)}`):a.push("/onboarding/confirmed")}catch(a){p(a?.message||"Booking failed.")}finally{n(!1)}}return(0,c.useEffect)(()=>{e("nexus_terms")?e("nexus_lead")?t():a.push("/onboarding/details"):a.push("/onboarding/terms")},[]),(0,b.jsx)("div",{className:"section",children:(0,b.jsxs)("div",{className:"card",children:[(0,b.jsx)("div",{className:"badge",children:"Step 3 of 3"}),(0,b.jsx)("h1",{className:"h1",style:{fontSize:44,marginTop:12},children:"Book your onboarding call"}),(0,b.jsx)("p",{className:"p",children:"Select a slot below. Times are shown in your device time."}),(0,b.jsx)("div",{className:"card",style:{marginTop:14},children:k?(0,b.jsx)("div",{className:"p",children:"Loading slots..."}):0===g.length?(0,b.jsx)("div",{className:"p",children:"No slots available right now. Please check back later."}):(0,b.jsx)("div",{style:{display:"grid",gap:12},children:g.map(a=>{let c=i===a.id;return(0,b.jsx)("label",{className:"card",style:{cursor:"pointer",borderColor:c?"rgba(120,200,255,0.8)":"rgba(255,255,255,0.12)",background:c?"rgba(10,16,32,0.65)":"rgba(10,16,32,0.35)"},children:(0,b.jsxs)("div",{style:{display:"flex",gap:12,alignItems:"center"},children:[(0,b.jsx)("input",{type:"radio",name:"slot",checked:c,onChange:()=>j(a.id)}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{style:{fontWeight:800,fontSize:20},children:f(a.startsAt)}),(0,b.jsxs)("div",{className:"p",style:{marginTop:4,opacity:.85},children:["Ends: ",f(a.endsAt)]})]})]})},a.id)})})}),o&&(0,b.jsxs)("div",{className:"card",style:{borderColor:"rgba(255,120,120,0.6)",marginTop:14},children:[(0,b.jsx)("b",{style:{color:"#ffd4d4"},children:"Fix this"}),(0,b.jsx)("div",{className:"p",style:{marginTop:6},children:o})]}),q&&(0,b.jsxs)("div",{className:"card",style:{borderColor:"rgba(120,255,160,0.35)",marginTop:14},children:[(0,b.jsx)("b",{style:{color:"#d6ffe3"},children:"Done"}),(0,b.jsx)("div",{className:"p",style:{marginTop:6},children:q})]}),(0,b.jsxs)("div",{style:{display:"flex",gap:12,flexWrap:"wrap",marginTop:16},children:[(0,b.jsx)("button",{className:"btn btnGhost",onClick:()=>a.push("/onboarding/details"),children:"Back"}),(0,b.jsx)("button",{className:"btn btnPrimary",onClick:u,disabled:m||0===g.length,children:m?"Booking...":"Book"}),(0,b.jsx)("button",{className:"btn btnGhost",onClick:t,disabled:k,children:"Refresh slots"})]})]})})}a.s(["default",()=>g])}];

//# sourceMappingURL=%5Broot-of-the-server%5D__ab4173ce._.js.map