module.exports=[72131,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].React},9270,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.AppRouterContext},36313,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.HooksClientContext},18341,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.ServerInsertedHtml},18622,(a,b,c)=>{b.exports=a.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},20635,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},42602,(a,b,c)=>{"use strict";b.exports=a.r(18622)},87924,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactJsxRuntime},91808,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944);function e(a,b){let c=new Date(a);return new Intl.DateTimeFormat(void 0,{weekday:"short",day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit",timeZone:b||void 0}).format(c)}function f(){let a=(0,d.useRouter)(),[f,g]=(0,c.useState)([]),[h,i]=(0,c.useState)(!1),[j,k]=(0,c.useState)(""),[l,m]=(0,c.useState)(""),n=(0,c.useMemo)(()=>"Nexus GPT",[]);async function o(){k(""),m(""),i(!0);try{let a=await fetch("/api/admin/leads",{cache:"no-store"}),b=await a.json().catch(()=>({}));if(!a.ok)throw Error(b?.error||`Failed (${a.status})`);g(Array.isArray(b?.leads)?b.leads:[])}catch(a){k(a?.message||"Failed to load leads."),g([])}finally{i(!1)}}async function p(a){try{let b=function(a){let b=a.latestBooking;if(!b?.startsAt||!b?.endsAt)return`Hi! This is ${n}. We received your details, but your booking time isn't attached yet. Reply here and weâ€™ll confirm a time.`;let c=b.timezone||a.timezone||"Asia/Colombo",d=e(b.startsAt,c),f=e(b.endsAt,c),g=b.zoomJoinUrl||"[PASTE_ZOOM_LINK_HERE]";return`Hi! This is ${n} âœ…

Your onboarding call is booked.

ðŸ•’ Time: ${d} â€“ ${f}
ðŸŒ Timezone: ${c}
ðŸ”— Zoom: ${g}

Reply â€œOKâ€ to confirm.`}(a);await navigator.clipboard.writeText(b),m("Copied WhatsApp message âœ…"),setTimeout(()=>m(""),1400)}catch{k("Could not copy. Your browser blocked clipboard access.")}}async function q(a){if(k(""),m(""),confirm("Delete this lead? This removes their bookings too."))try{let b=await fetch(`/api/admin/leads/${a}`,{method:"DELETE"}),c=await b.json().catch(()=>({}));if(!b.ok)throw Error(c?.error||`Delete failed (${b.status})`);m("Deleted âœ…"),g(b=>b.filter(b=>b.id!==a)),setTimeout(()=>m(""),1400)}catch(a){k(a?.message||"Delete failed.")}}return(0,c.useEffect)(()=>{o()},[]),(0,b.jsx)("div",{className:"section",children:(0,b.jsxs)("div",{className:"card",children:[(0,b.jsx)("div",{className:"badge",children:"Admin"}),(0,b.jsx)("h1",{className:"h1",style:{fontSize:44,marginTop:12},children:"Leads"}),(0,b.jsx)("p",{className:"p",children:"View client details + latest booking, copy a WhatsApp message, then delete once contacted."}),(0,b.jsxs)("div",{style:{display:"flex",gap:12,flexWrap:"wrap",marginTop:14},children:[(0,b.jsx)("button",{className:"btn btnGhost",onClick:()=>a.push("/admin/slots"),children:"Slots"}),(0,b.jsx)("button",{className:"btn btnGhost",onClick:o,disabled:h,children:h?"Refreshing...":"Refresh"})]}),j&&(0,b.jsxs)("div",{className:"card",style:{borderColor:"rgba(255,120,120,0.6)",marginTop:14},children:[(0,b.jsx)("b",{style:{color:"#ffd4d4"},children:"Fix this"}),(0,b.jsx)("div",{className:"p",style:{marginTop:6},children:j})]}),l&&(0,b.jsxs)("div",{className:"card",style:{borderColor:"rgba(120,255,160,0.35)",marginTop:14},children:[(0,b.jsx)("b",{style:{color:"#d6ffe3"},children:"Done"}),(0,b.jsx)("div",{className:"p",style:{marginTop:6},children:l})]}),(0,b.jsx)("div",{className:"card",style:{marginTop:14,overflowX:"auto"},children:0!==f.length||h?(0,b.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",minWidth:900},children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{style:{textAlign:"left",opacity:.9},children:[(0,b.jsx)("th",{style:{padding:10},children:"Email"}),(0,b.jsx)("th",{style:{padding:10},children:"WhatsApp"}),(0,b.jsx)("th",{style:{padding:10},children:"Country"}),(0,b.jsx)("th",{style:{padding:10},children:"Lead TZ"}),(0,b.jsx)("th",{style:{padding:10},children:"Latest booking"}),(0,b.jsx)("th",{style:{padding:10},children:"Actions"})]})}),(0,b.jsx)("tbody",{children:f.map(a=>{let c=a.latestBooking,d=c?.startsAt&&c?.endsAt?`${e(c.startsAt,c.timezone||a.timezone)} â†’ ${e(c.endsAt,c.timezone||a.timezone)}`:"â€”";return(0,b.jsxs)("tr",{style:{borderTop:"1px solid rgba(255,255,255,0.08)"},children:[(0,b.jsx)("td",{style:{padding:10,fontWeight:650},children:a.email}),(0,b.jsx)("td",{style:{padding:10},children:a.phone}),(0,b.jsx)("td",{style:{padding:10},children:a.country}),(0,b.jsx)("td",{style:{padding:10},children:a.timezone}),(0,b.jsxs)("td",{style:{padding:10},children:[(0,b.jsx)("div",{style:{fontWeight:650},children:d}),c?.id?(0,b.jsxs)("div",{className:"p",style:{marginTop:4,opacity:.8},children:["Booking ID: ",c.id]}):null]}),(0,b.jsx)("td",{style:{padding:10},children:(0,b.jsxs)("div",{style:{display:"flex",gap:10,flexWrap:"wrap"},children:[(0,b.jsx)("button",{className:"btn btnGhost",onClick:()=>p(a),children:"Copy WhatsApp message"}),(0,b.jsx)("button",{className:"btn btnGhost",onClick:()=>q(a.id),style:{borderColor:"rgba(255,120,120,0.35)"},children:"Delete"})]})})]},a.id)})})]}):(0,b.jsx)("div",{className:"p",children:"No leads yet."})})]})})}a.s(["default",()=>f])}];

//# sourceMappingURL=%5Broot-of-the-server%5D__7e6993d2._.js.map