module.exports=[18622,(e,t,o)=>{t.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(e,t,o)=>{t.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(e,t,o)=>{t.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},24725,(e,t,o)=>{t.exports=e.x("next/dist/server/app-render/after-task-async-storage.external.js",()=>require("next/dist/server/app-render/after-task-async-storage.external.js"))},70406,(e,t,o)=>{t.exports=e.x("next/dist/compiled/@opentelemetry/api",()=>require("next/dist/compiled/@opentelemetry/api"))},14747,(e,t,o)=>{t.exports=e.x("path",()=>require("path"))},24361,(e,t,o)=>{t.exports=e.x("util",()=>require("util"))},93695,(e,t,o)=>{t.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},63021,(e,t,o)=>{t.exports=e.x("@prisma/client-2c3a283f134fdcb6",()=>require("@prisma/client-2c3a283f134fdcb6"))},15270,e=>{"use strict";var t=e.i(63021);let o=globalThis.prisma??new t.PrismaClient;e.s(["prisma",0,o])},49719,(e,t,o)=>{t.exports=e.x("assert",()=>require("assert"))},45706,(e,t,o)=>{t.exports=e.x("querystring",()=>require("querystring"))},75096,e=>{e.v({name:"openid-client",version:"5.7.1",description:"OpenID Connect Relying Party (RP, Client) implementation for Node.js runtime, supports passportjs",keywords:["auth","authentication","basic","certified","client","connect","dynamic","electron","hybrid","identity","implicit","oauth","oauth2","oidc","openid","passport","relying party","strategy"],homepage:"https://github.com/panva/openid-client",repository:"panva/openid-client",funding:{url:"https://github.com/sponsors/panva"},license:"MIT",author:"Filip Skokan <panva.ip@gmail.com>",exports:{types:"./types/index.d.ts",import:"./lib/index.mjs",require:"./lib/index.js"},main:"./lib/index.js",types:"./types/index.d.ts",files:["lib","types/index.d.ts"],scripts:{format:"npx prettier --loglevel silent --write ./lib ./test ./certification ./types",test:"mocha test/**/*.test.js"},dependencies:{jose:"^4.15.9","lru-cache":"^6.0.0","object-hash":"^2.2.0","oidc-token-hash":"^5.0.3"},devDependencies:{"@types/node":"^16.18.106","@types/passport":"^1.0.16",base64url:"^3.0.1",chai:"^4.5.0",mocha:"^10.7.3",nock:"^13.5.5",prettier:"^2.8.8","readable-mock-req":"^0.2.2",sinon:"^9.2.4",timekeeper:"^2.3.1"},"standard-version":{scripts:{postchangelog:"sed -i '' -e 's/### \\[/## [/g' CHANGELOG.md"},types:[{type:"feat",section:"Features"},{type:"fix",section:"Fixes"},{type:"chore",hidden:!0},{type:"docs",hidden:!0},{type:"style",hidden:!0},{type:"refactor",section:"Refactor",hidden:!1},{type:"perf",section:"Performance",hidden:!1},{type:"test",hidden:!0}]}})},88947,(e,t,o)=>{t.exports=e.x("stream",()=>require("stream"))},54799,(e,t,o)=>{t.exports=e.x("crypto",()=>require("crypto"))},874,(e,t,o)=>{t.exports=e.x("buffer",()=>require("buffer"))},27699,(e,t,o)=>{t.exports=e.x("events",()=>require("events"))},92509,(e,t,o)=>{t.exports=e.x("url",()=>require("url"))},22734,(e,t,o)=>{t.exports=e.x("fs",()=>require("fs"))},21517,(e,t,o)=>{t.exports=e.x("http",()=>require("http"))},24836,(e,t,o)=>{t.exports=e.x("https",()=>require("https"))},6461,(e,t,o)=>{t.exports=e.x("zlib",()=>require("zlib"))},63818,e=>{e.v({name:"nodemailer",version:"7.0.13",description:"Easy as cake e-mail sending from your Node.js applications",main:"lib/nodemailer.js",scripts:{test:"node --test --test-concurrency=1 test/**/*.test.js test/**/*-test.js","test:coverage":"c8 node --test --test-concurrency=1 test/**/*.test.js test/**/*-test.js",format:'prettier --write "**/*.{js,json,md}"',"format:check":'prettier --check "**/*.{js,json,md}"',lint:"eslint .","lint:fix":"eslint . --fix",update:"rm -rf node_modules/ package-lock.json && ncu -u && npm install"},repository:{type:"git",url:"https://github.com/nodemailer/nodemailer.git"},keywords:["Nodemailer"],author:"Andris Reinman",license:"MIT-0",bugs:{url:"https://github.com/nodemailer/nodemailer/issues"},homepage:"https://nodemailer.com/",devDependencies:{"@aws-sdk/client-sesv2":"3.975.0",bunyan:"1.8.15",c8:"10.1.3",eslint:"9.39.2","eslint-config-prettier":"10.1.8",globals:"17.1.0",libbase64:"1.3.0",libmime:"5.3.7",libqp:"2.1.1","nodemailer-ntlm-auth":"1.0.4",prettier:"3.8.1",proxy:"1.0.2","proxy-test-server":"1.0.0","smtp-server":"3.18.0"},engines:{node:">=6.0.0"}})},4446,(e,t,o)=>{t.exports=e.x("net",()=>require("net"))},79594,(e,t,o)=>{t.exports=e.x("dns",()=>require("dns"))},46786,(e,t,o)=>{t.exports=e.x("os",()=>require("os"))},55004,(e,t,o)=>{t.exports=e.x("tls",()=>require("tls"))},55381,e=>{e.v(JSON.parse('{"1und1":{"description":"1&1 Mail (German hosting provider)","host":"smtp.1und1.de","port":465,"secure":true,"authMethod":"LOGIN"},"126":{"description":"126 Mail (NetEase)","host":"smtp.126.com","port":465,"secure":true},"163":{"description":"163 Mail (NetEase)","host":"smtp.163.com","port":465,"secure":true},"Aliyun":{"description":"Alibaba Cloud Mail","domains":["aliyun.com"],"host":"smtp.aliyun.com","port":465,"secure":true},"AliyunQiye":{"description":"Alibaba Cloud Enterprise Mail","host":"smtp.qiye.aliyun.com","port":465,"secure":true},"AOL":{"description":"AOL Mail","domains":["aol.com"],"host":"smtp.aol.com","port":587},"Aruba":{"description":"Aruba PEC (Italian email provider)","domains":["aruba.it","pec.aruba.it"],"aliases":["Aruba PEC"],"host":"smtps.aruba.it","port":465,"secure":true,"authMethod":"LOGIN"},"Bluewin":{"description":"Bluewin (Swiss email provider)","host":"smtpauths.bluewin.ch","domains":["bluewin.ch"],"port":465},"BOL":{"description":"BOL Mail (Brazilian provider)","domains":["bol.com.br"],"host":"smtp.bol.com.br","port":587,"requireTLS":true},"DebugMail":{"description":"DebugMail (email testing service)","host":"debugmail.io","port":25},"Disroot":{"description":"Disroot (privacy-focused provider)","domains":["disroot.org"],"host":"disroot.org","port":587,"secure":false,"authMethod":"LOGIN"},"DynectEmail":{"description":"Dyn Email Delivery","aliases":["Dynect"],"host":"smtp.dynect.net","port":25},"ElasticEmail":{"description":"Elastic Email","aliases":["Elastic Email"],"host":"smtp.elasticemail.com","port":465,"secure":true},"Ethereal":{"description":"Ethereal Email (email testing service)","aliases":["ethereal.email"],"host":"smtp.ethereal.email","port":587},"FastMail":{"description":"FastMail","domains":["fastmail.fm"],"host":"smtp.fastmail.com","port":465,"secure":true},"Feishu Mail":{"description":"Feishu Mail (Lark)","aliases":["Feishu","FeishuMail"],"domains":["www.feishu.cn"],"host":"smtp.feishu.cn","port":465,"secure":true},"Forward Email":{"description":"Forward Email (email forwarding service)","aliases":["FE","ForwardEmail"],"domains":["forwardemail.net"],"host":"smtp.forwardemail.net","port":465,"secure":true},"GandiMail":{"description":"Gandi Mail","aliases":["Gandi","Gandi Mail"],"host":"mail.gandi.net","port":587},"Gmail":{"description":"Gmail","aliases":["Google Mail"],"domains":["gmail.com","googlemail.com"],"host":"smtp.gmail.com","port":465,"secure":true},"GMX":{"description":"GMX Mail","domains":["gmx.com","gmx.net","gmx.de"],"host":"mail.gmx.com","port":587},"Godaddy":{"description":"GoDaddy Email (US)","host":"smtpout.secureserver.net","port":25},"GodaddyAsia":{"description":"GoDaddy Email (Asia)","host":"smtp.asia.secureserver.net","port":25},"GodaddyEurope":{"description":"GoDaddy Email (Europe)","host":"smtp.europe.secureserver.net","port":25},"hot.ee":{"description":"Hot.ee (Estonian email provider)","host":"mail.hot.ee"},"Hotmail":{"description":"Outlook.com / Hotmail","aliases":["Outlook","Outlook.com","Hotmail.com"],"domains":["hotmail.com","outlook.com"],"host":"smtp-mail.outlook.com","port":587},"iCloud":{"description":"iCloud Mail","aliases":["Me","Mac"],"domains":["me.com","mac.com"],"host":"smtp.mail.me.com","port":587},"Infomaniak":{"description":"Infomaniak Mail (Swiss hosting provider)","host":"mail.infomaniak.com","domains":["ik.me","ikmail.com","etik.com"],"port":587},"KolabNow":{"description":"KolabNow (secure email service)","domains":["kolabnow.com"],"aliases":["Kolab"],"host":"smtp.kolabnow.com","port":465,"secure":true,"authMethod":"LOGIN"},"Loopia":{"description":"Loopia (Swedish hosting provider)","host":"mailcluster.loopia.se","port":465},"Loops":{"description":"Loops","host":"smtp.loops.so","port":587},"mail.ee":{"description":"Mail.ee (Estonian email provider)","host":"smtp.mail.ee"},"Mail.ru":{"description":"Mail.ru","host":"smtp.mail.ru","port":465,"secure":true},"Mailcatch.app":{"description":"Mailcatch (email testing service)","host":"sandbox-smtp.mailcatch.app","port":2525},"Maildev":{"description":"MailDev (local email testing)","port":1025,"ignoreTLS":true},"MailerSend":{"description":"MailerSend","host":"smtp.mailersend.net","port":587},"Mailgun":{"description":"Mailgun","host":"smtp.mailgun.org","port":465,"secure":true},"Mailjet":{"description":"Mailjet","host":"in.mailjet.com","port":587},"Mailosaur":{"description":"Mailosaur (email testing service)","host":"mailosaur.io","port":25},"Mailtrap":{"description":"Mailtrap","host":"live.smtp.mailtrap.io","port":587},"Mandrill":{"description":"Mandrill (by Mailchimp)","host":"smtp.mandrillapp.com","port":587},"Naver":{"description":"Naver Mail (Korean email provider)","host":"smtp.naver.com","port":587},"OhMySMTP":{"description":"OhMySMTP (email delivery service)","host":"smtp.ohmysmtp.com","port":587,"secure":false},"One":{"description":"One.com Email","host":"send.one.com","port":465,"secure":true},"OpenMailBox":{"description":"OpenMailBox","aliases":["OMB","openmailbox.org"],"host":"smtp.openmailbox.org","port":465,"secure":true},"Outlook365":{"description":"Microsoft 365 / Office 365","host":"smtp.office365.com","port":587,"secure":false},"Postmark":{"description":"Postmark","aliases":["PostmarkApp"],"host":"smtp.postmarkapp.com","port":2525},"Proton":{"description":"Proton Mail","aliases":["ProtonMail","Proton.me","Protonmail.com","Protonmail.ch"],"domains":["proton.me","protonmail.com","pm.me","protonmail.ch"],"host":"smtp.protonmail.ch","port":587,"requireTLS":true},"qiye.aliyun":{"description":"Alibaba Mail Enterprise Edition","host":"smtp.mxhichina.com","port":"465","secure":true},"QQ":{"description":"QQ Mail","domains":["qq.com"],"host":"smtp.qq.com","port":465,"secure":true},"QQex":{"description":"QQ Enterprise Mail","aliases":["QQ Enterprise"],"domains":["exmail.qq.com"],"host":"smtp.exmail.qq.com","port":465,"secure":true},"Resend":{"description":"Resend","host":"smtp.resend.com","port":465,"secure":true},"Runbox":{"description":"Runbox (Norwegian email provider)","domains":["runbox.com"],"host":"smtp.runbox.com","port":465,"secure":true},"SendCloud":{"description":"SendCloud (Chinese email delivery)","host":"smtp.sendcloud.net","port":2525},"SendGrid":{"description":"SendGrid","host":"smtp.sendgrid.net","port":587},"SendinBlue":{"description":"Brevo (formerly Sendinblue)","aliases":["Brevo"],"host":"smtp-relay.brevo.com","port":587},"SendPulse":{"description":"SendPulse","host":"smtp-pulse.com","port":465,"secure":true},"SES":{"description":"AWS SES US East (N. Virginia)","host":"email-smtp.us-east-1.amazonaws.com","port":465,"secure":true},"SES-AP-NORTHEAST-1":{"description":"AWS SES Asia Pacific (Tokyo)","host":"email-smtp.ap-northeast-1.amazonaws.com","port":465,"secure":true},"SES-AP-NORTHEAST-2":{"description":"AWS SES Asia Pacific (Seoul)","host":"email-smtp.ap-northeast-2.amazonaws.com","port":465,"secure":true},"SES-AP-NORTHEAST-3":{"description":"AWS SES Asia Pacific (Osaka)","host":"email-smtp.ap-northeast-3.amazonaws.com","port":465,"secure":true},"SES-AP-SOUTH-1":{"description":"AWS SES Asia Pacific (Mumbai)","host":"email-smtp.ap-south-1.amazonaws.com","port":465,"secure":true},"SES-AP-SOUTHEAST-1":{"description":"AWS SES Asia Pacific (Singapore)","host":"email-smtp.ap-southeast-1.amazonaws.com","port":465,"secure":true},"SES-AP-SOUTHEAST-2":{"description":"AWS SES Asia Pacific (Sydney)","host":"email-smtp.ap-southeast-2.amazonaws.com","port":465,"secure":true},"SES-CA-CENTRAL-1":{"description":"AWS SES Canada (Central)","host":"email-smtp.ca-central-1.amazonaws.com","port":465,"secure":true},"SES-EU-CENTRAL-1":{"description":"AWS SES Europe (Frankfurt)","host":"email-smtp.eu-central-1.amazonaws.com","port":465,"secure":true},"SES-EU-NORTH-1":{"description":"AWS SES Europe (Stockholm)","host":"email-smtp.eu-north-1.amazonaws.com","port":465,"secure":true},"SES-EU-WEST-1":{"description":"AWS SES Europe (Ireland)","host":"email-smtp.eu-west-1.amazonaws.com","port":465,"secure":true},"SES-EU-WEST-2":{"description":"AWS SES Europe (London)","host":"email-smtp.eu-west-2.amazonaws.com","port":465,"secure":true},"SES-EU-WEST-3":{"description":"AWS SES Europe (Paris)","host":"email-smtp.eu-west-3.amazonaws.com","port":465,"secure":true},"SES-SA-EAST-1":{"description":"AWS SES South America (São Paulo)","host":"email-smtp.sa-east-1.amazonaws.com","port":465,"secure":true},"SES-US-EAST-1":{"description":"AWS SES US East (N. Virginia)","host":"email-smtp.us-east-1.amazonaws.com","port":465,"secure":true},"SES-US-EAST-2":{"description":"AWS SES US East (Ohio)","host":"email-smtp.us-east-2.amazonaws.com","port":465,"secure":true},"SES-US-GOV-EAST-1":{"description":"AWS SES GovCloud (US-East)","host":"email-smtp.us-gov-east-1.amazonaws.com","port":465,"secure":true},"SES-US-GOV-WEST-1":{"description":"AWS SES GovCloud (US-West)","host":"email-smtp.us-gov-west-1.amazonaws.com","port":465,"secure":true},"SES-US-WEST-1":{"description":"AWS SES US West (N. California)","host":"email-smtp.us-west-1.amazonaws.com","port":465,"secure":true},"SES-US-WEST-2":{"description":"AWS SES US West (Oregon)","host":"email-smtp.us-west-2.amazonaws.com","port":465,"secure":true},"Seznam":{"description":"Seznam Email (Czech email provider)","aliases":["Seznam Email"],"domains":["seznam.cz","email.cz","post.cz","spoluzaci.cz"],"host":"smtp.seznam.cz","port":465,"secure":true},"SMTP2GO":{"description":"SMTP2GO","host":"mail.smtp2go.com","port":2525},"Sparkpost":{"description":"SparkPost","aliases":["SparkPost","SparkPost Mail"],"domains":["sparkpost.com"],"host":"smtp.sparkpostmail.com","port":587,"secure":false},"Tipimail":{"description":"Tipimail (email delivery service)","host":"smtp.tipimail.com","port":587},"Tutanota":{"description":"Tutanota (Tuta Mail)","domains":["tutanota.com","tuta.com","tutanota.de","tuta.io"],"host":"smtp.tutanota.com","port":465,"secure":true},"Yahoo":{"description":"Yahoo Mail","domains":["yahoo.com"],"host":"smtp.mail.yahoo.com","port":465,"secure":true},"Yandex":{"description":"Yandex Mail","domains":["yandex.ru"],"host":"smtp.yandex.ru","port":465,"secure":true},"Zimbra":{"description":"Zimbra Mail Server","aliases":["Zimbra Collaboration"],"host":"smtp.zimbra.com","port":587,"requireTLS":true},"Zoho":{"description":"Zoho Mail","host":"smtp.zoho.com","port":465,"secure":true,"authMethod":"LOGIN"}}'))},33405,(e,t,o)=>{t.exports=e.x("child_process",()=>require("child_process"))},76081,e=>{"use strict";var t=e.i(15270);async function o(){let e=await t.prisma.adminSetting.findFirst();return e||(e=await t.prisma.adminSetting.create({data:{zoomRecurringLink:process.env.ZOOM_RECURRING_LINK||"",graceAccessAllowed:!0,allowedDaysCsv:"1,2,3,4,5,6,7",bookingDurationM:30,bufferMinutes:10,dailyStartHour:9,dailyEndHour:17}})),e}async function i(e){let i=await o(),r=new Date(e);if(Number.isNaN(r.getTime()))throw Error("Invalid date");let s=r.getDay();if(!i.allowedDaysCsv.split(",").map(e=>Number(e.trim())).filter(e=>e>=1&&e<=7).includes(0===s?7:s))return[];let a=new Date(e+"T00:00:00.000Z"),n=new Date(e+"T23:59:59.999Z"),p=new Set((await t.prisma.booking.findMany({where:{date:{gte:a,lte:n},status:"BOOKED"}})).map(e=>e.date.toISOString().slice(11,16))),l=[],c=i.bookingDurationM,d=i.bufferMinutes,m=60*i.dailyStartHour,u=60*i.dailyEndHour;for(;m+c<=u;){let e=String(Math.floor(m/60)).padStart(2,"0"),t=String(m%60).padStart(2,"0"),o=`${e}:${t}`;p.has(o)||l.push(o),m+=c+d}return l}e.s(["computeSlotsForDate",()=>i,"getAdminSettings",()=>o])},2740,e=>{"use strict";var t=e.i(47909),o=e.i(74017),i=e.i(96250),r=e.i(59756),s=e.i(61916),a=e.i(74677),n=e.i(69741),p=e.i(16795),l=e.i(87718),c=e.i(95169),d=e.i(47587),m=e.i(66012),u=e.i(70101),h=e.i(26937),S=e.i(10372),E=e.i(93695);e.i(52474);var x=e.i(220),g=e.i(89171),f=e.i(15270),y=e.i(76081),b=e.i(86668),v=e.i(57660),w=e.i(68105);async function A(e){let t=await (0,v.getServerSession)(w.authOptions);if(!t?.user?.email)return g.NextResponse.json({error:"Unauthorized"},{status:401});let{date:o,time:i}=await e.json(),r=await f.prisma.user.findUnique({where:{email:t.user.email}});if(!r)return g.NextResponse.json({error:"User not found"},{status:404});if(!await f.prisma.policyAcceptance.findUnique({where:{userId:r.id}}))return g.NextResponse.json({error:"Policies not accepted"},{status:428});if(!await f.prisma.kycRecord.findUnique({where:{userId:r.id}}))return g.NextResponse.json({error:"KYC not submitted"},{status:428});let s=await f.prisma.user.findUnique({where:{id:r.id},select:{selectedPoolId:!0}});if(!s?.selectedPoolId)return g.NextResponse.json({error:"Select an account pool first"},{status:428});let a=await f.prisma.poolSlot.findFirst({where:{poolId:s.selectedPoolId,isAvailable:!0},orderBy:{createdAt:"asc"},include:{pool:!0}});if(!a)return g.NextResponse.json({error:"No available slots in this pool"},{status:409});let n=await (0,y.getAdminSettings)(),p=n.zoomRecurringLink||process.env.ZOOM_RECURRING_LINK||"https://us05web.zoom.us/j/84080899947?pwd=L2aAYxznDlmuZbpwbaITGCn4O1w2To.1",l=new Date(`${o}T${i}:00.000+05:30`),c=await f.prisma.booking.create({data:{userId:r.id,date:l,durationM:n.bookingDurationM}});return await (0,b.sendEmail)(r.email,"Your Nexus GPT onboarding call (Zoom link inside)",`
      <div style="font-family:Arial;line-height:1.6;padding:16px">
        <h2>Nexus GPT – Onboarding Call</h2>
        <p>Your Zoom call is booked.</p>
        <p><b>Date & time:</b> ${o} at ${i} (Sri Lanka Time)</p>
        <p><b>Zoom link:</b> <a href="${p}">${p}</a></p>
        <p><b>Your selected pool:</b> ${a.pool.name}</p>
        <hr/>
        <p style="color:#667;font-size:13px">
          Trial starts <b>after the call</b> is marked completed by admin. Support: AI.Nexus.store@gmail.com | 0766398548
        </p>
      </div>
    `),g.NextResponse.json({ok:!0,booking:c})}e.s(["POST",()=>A],14115);var M=e.i(14115);let R=new t.AppRouteRouteModule({definition:{kind:o.RouteKind.APP_ROUTE,page:"/api/booking/create/route",pathname:"/api/booking/create",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/app/api/booking/create/route.ts",nextConfigOutput:"",userland:M}),{workAsyncStorage:k,workUnitAsyncStorage:T,serverHooks:O}=R;function N(){return(0,i.patchFetch)({workAsyncStorage:k,workUnitAsyncStorage:T})}async function P(e,t,i){R.isDev&&(0,r.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let g="/api/booking/create/route";g=g.replace(/\/index$/,"")||"/";let f=await R.prepare(e,t,{srcPage:g,multiZoneDraftMode:!1});if(!f)return t.statusCode=400,t.end("Bad Request"),null==i.waitUntil||i.waitUntil.call(i,Promise.resolve()),null;let{buildId:y,params:b,nextConfig:v,parsedUrl:w,isDraftMode:A,prerenderManifest:M,routerServerContext:k,isOnDemandRevalidate:T,revalidateOnlyGenerated:O,resolvedPathname:N,clientReferenceManifest:P,serverActionsManifest:C}=f,q=(0,n.normalizeAppPath)(g),j=!!(M.dynamicRoutes[q]||M.routes[N]),U=async()=>((null==k?void 0:k.render404)?await k.render404(e,t,w,!1):t.end("This page could not be found"),null);if(j&&!A){let e=!!M.routes[N],t=M.dynamicRoutes[q];if(t&&!1===t.fallback&&!e){if(v.experimental.adapterPath)return await U();throw new E.NoFallbackError}}let z=null;!j||R.isDev||A||(z="/index"===(z=N)?"/":z);let D=!0===R.isDev||!j,I=j&&!D;C&&P&&(0,a.setManifestsSingleton)({page:g,clientReferenceManifest:P,serverActionsManifest:C});let G=e.method||"GET",H=(0,s.getTracer)(),L=H.getActiveScopeSpan(),W={params:b,prerenderManifest:M,renderOpts:{experimental:{authInterrupts:!!v.experimental.authInterrupts},cacheComponents:!!v.cacheComponents,supportsDynamicResponse:D,incrementalCache:(0,r.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:v.cacheLife,waitUntil:i.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,o,i,r)=>R.onRequestError(e,t,i,r,k)},sharedContext:{buildId:y}},_=new p.NodeNextRequest(e),F=new p.NodeNextResponse(t),B=l.NextRequestAdapter.fromNodeNextRequest(_,(0,l.signalFromNodeResponse)(t));try{let a=async e=>R.handle(B,W).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let o=H.getRootSpanAttributes();if(!o)return;if(o.get("next.span_type")!==c.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${o.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let i=o.get("next.route");if(i){let t=`${G} ${i}`;e.setAttributes({"next.route":i,"http.route":i,"next.span_name":t}),e.updateName(t)}else e.updateName(`${G} ${g}`)}),n=!!(0,r.getRequestMeta)(e,"minimalMode"),p=async r=>{var s,p;let l=async({previousCacheEntry:o})=>{try{if(!n&&T&&O&&!o)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let s=await a(r);e.fetchMetrics=W.renderOpts.fetchMetrics;let p=W.renderOpts.pendingWaitUntil;p&&i.waitUntil&&(i.waitUntil(p),p=void 0);let l=W.renderOpts.collectedTags;if(!j)return await (0,m.sendResponse)(_,F,s,W.renderOpts.pendingWaitUntil),null;{let e=await s.blob(),t=(0,u.toNodeOutgoingHttpHeaders)(s.headers);l&&(t[S.NEXT_CACHE_TAGS_HEADER]=l),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let o=void 0!==W.renderOpts.collectedRevalidate&&!(W.renderOpts.collectedRevalidate>=S.INFINITE_CACHE)&&W.renderOpts.collectedRevalidate,i=void 0===W.renderOpts.collectedExpire||W.renderOpts.collectedExpire>=S.INFINITE_CACHE?void 0:W.renderOpts.collectedExpire;return{value:{kind:x.CachedRouteKind.APP_ROUTE,status:s.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:o,expire:i}}}}catch(t){throw(null==o?void 0:o.isStale)&&await R.onRequestError(e,t,{routerKind:"App Router",routePath:g,routeType:"route",revalidateReason:(0,d.getRevalidateReason)({isStaticGeneration:I,isOnDemandRevalidate:T})},!1,k),t}},c=await R.handleResponse({req:e,nextConfig:v,cacheKey:z,routeKind:o.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:M,isRoutePPREnabled:!1,isOnDemandRevalidate:T,revalidateOnlyGenerated:O,responseGenerator:l,waitUntil:i.waitUntil,isMinimalMode:n});if(!j)return null;if((null==c||null==(s=c.value)?void 0:s.kind)!==x.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==c||null==(p=c.value)?void 0:p.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});n||t.setHeader("x-nextjs-cache",T?"REVALIDATED":c.isMiss?"MISS":c.isStale?"STALE":"HIT"),A&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let E=(0,u.fromNodeOutgoingHttpHeaders)(c.value.headers);return n&&j||E.delete(S.NEXT_CACHE_TAGS_HEADER),!c.cacheControl||t.getHeader("Cache-Control")||E.get("Cache-Control")||E.set("Cache-Control",(0,h.getCacheControlHeader)(c.cacheControl)),await (0,m.sendResponse)(_,F,new Response(c.value.body,{headers:E,status:c.value.status||200})),null};L?await p(L):await H.withPropagatedContext(e.headers,()=>H.trace(c.BaseServerSpan.handleRequest,{spanName:`${G} ${g}`,kind:s.SpanKind.SERVER,attributes:{"http.method":G,"http.target":e.url}},p))}catch(t){if(t instanceof E.NoFallbackError||await R.onRequestError(e,t,{routerKind:"App Router",routePath:q,routeType:"route",revalidateReason:(0,d.getRevalidateReason)({isStaticGeneration:I,isOnDemandRevalidate:T})},!1,k),j)throw t;return await (0,m.sendResponse)(_,F,new Response(null,{status:500})),null}}e.s(["handler",()=>P,"patchFetch",()=>N,"routeModule",()=>R,"serverHooks",()=>O,"workAsyncStorage",()=>k,"workUnitAsyncStorage",()=>T],2740)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__5deac921._.js.map